# DRFBooking

# Запуск
1. Скопируйте репозиторий: 
```
git clone git@github.com:MaximBrezhnev/DRFBooking.git
```

2. Создать файл `.secrets.yaml` по аналогии с `.secrets.yaml.example` в той же директории.

3. Для запуска сервиса, находясь в директории, где расположен `Makefile`, выполните команду:
```
make dev
```

Примечание: должны быть предварительно установлены Python, Docker, Poetry.

# Тестирование
Для запуска автотестов в уже скопированном репозитории, находясь в директории, где расположен `Makefile`, выполните команду:
```
make test
```

# API Документация — Работа с Номерами Отеля (Room)

## Создание номера — `POST /api/v1/room/`

### Описание
Добавляет новый номер в отель.

### Тело запроса (JSON body)

| Поле            | Тип    | Обязательное | Описание                                                              |
|-----------------|--------|--------------|-----------------------------------------------------------------------|
| description     | string | Да           | Описание номера                                                       |
| price_per_night | string | Да           | Цена за ночь в формате строки. Максимум 8 знаков до и 2 после запятой |

### Пример запроса
```
curl -X POST http://localhost:8000/api/v1/room/ \
-H "Content-Type: application/json" \
-d '{"description": "Уютный номер с видом на сад", "price_per_night": "250.00"}'
```

### Пример ответа
```
{
  "room_id": "e7b3c9e7-5d3a-4a9a-999e-cf94e9c2a1a1"
}
```
Код ответа: 201 Сreated

## Получение списка номеров — `GET /api/v1/room/`

### Описание
Возвращает список всех номеров отеля.

### Параметры запроса

| Параметр | Описание                                               | Необязательный |
|----------|--------------------------------------------------------|----------------|
| ordering | Поле для сортировки (например, `price_per_night` или `-price_per_night`) | Да             |

### Пример запроса без сортировки

```
curl http://localhost:8000/api/v1/room/
```

### Пример ответа
```
[
  {
    "id": "e7b3c9e7-5d3a-4a9a-999e-cf94e9c2a1a1",
    "description": "Уютный номер с видом на сад",
    "price_per_night": "250.00"
  },
  {
    "id": "f9d4a1e8-4d62-4e8f-9bb6-78bc8cfa0c2e",
    "description": "Стандартный номер",
    "price_per_night": "150.00"
  }
]
```
Код ответа: 200 OK

## Удаление номера — `DELETE /api/v1/room/{room_id}/`

### Описание
Удаляет номер отеля по его `room_id` и все связанные с ним бронирования.

### Пример запроса

```
curl -X DELETE http://localhost:8000/api/v1/room/e7b3c9e7-5d3a-4a9a-999e-cf94e9c2a1a1/
```

### Пример ответа
* Пустое тело
* Код ответа: 204 No content


# API Документация — Работа с Бронированиями Номеров (Booking)

## Создание бронирования — `POST /api/v1/booking/`

### Описание
Создаёт бронь на номер отеля на заданный диапазон дат.

### Параметры (JSON body)

| Поле       | Тип          | Обязательное | Описание                            |
|------------|--------------|--------------|------------------------------------|
| room_id    | UUID         | Да           | Идентификатор номера               |
| date_start | string (date)| Да           | Дата начала бронирования (YYYY-MM-DD) |
| date_end   | string (date)| Да           | Дата окончания бронирования (YYYY-MM-DD) |

### Пример запроса

```
curl -X POST http://localhost:8000/api/v1/booking/ \
-H "Content-Type: application/json" \
-d '{"room_id": "e7b3c9e7-5d3a-4a9a-999e-cf94e9c2a1a1", "date_start": "2025-08-10", "date_end": "2025-08-15"}'
```

### Пример ответа
```
{
  "booking_id": "b1c9a9e8-7f5d-4a9a-999e-abcd1234ef56"
}
```
Код ответа: 201 Created

## Получение списка бронирований номера — `GET /api/v1/booking/room/{room_id}/`

### Описание
Возвращает список всех бронирований для конкретного номера отеля.

### Пример запроса

```
curl http://localhost:8000/api/v1/booking/room/e7b3c9e7-5d3a-4a9a-999e-cf94e9c2a1a1/
```

### Пример ответа
```
[
  {
    "id": "b1c9a9e8-7f5d-4a9a-999e-abcd1234ef56",
    "date_start": "2025-08-10",
    "date_end": "2025-08-15"
  },
  {
    "id": "d2e7b8c9-1f5a-4a9a-888e-1234abcd5678",
    "date_start": "2025-09-01",
    "date_end": "2025-09-05"
  }
]
```
Код ответа: 200 OK


## Удаление бронирования — `DELETE /api/v1/booking/{booking_id}/`

### Описание
Удаляет бронь по её идентификатору.

### Пример запроса
```
curl -X DELETE http://localhost:8000/api/v1/booking/b1c9a9e8-7f5d-4a9a-999e-abcd1234ef56/
```

### Пример ответа
* Пустое тело
* Код ответа: 204 No Content


